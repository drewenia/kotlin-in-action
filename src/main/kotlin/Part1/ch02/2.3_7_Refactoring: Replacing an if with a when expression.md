# Refactoring: Replacing an if with a when expression

if’in Kotlin’de bir expression olduğunu zaten görmüştün. Bu aynı zamanda Kotlin’de ternary operator bulunmamasının
sebebidir — if expression zaten bir value döndürebilir. Bu da eval function’ını expression-body syntax kullanacak
şekilde yeniden yazabileceğin anlamına gelir; return ifadesini ve süslü parantezleri kaldırır ve if expression’ını
function body olarak kullanırsın.

```kotlin
interface Expr
class Num(val value: Int) : Expr
class Sum(val left: Expr, val right: Expr) : Expr
class Sub(val left: Expr, val right: Expr) : Expr

fun eval(e: Expr): Int =
    if (e is Num) e.value
    else if (e is Sum) eval(e.right) + eval(e.left)
    else throw IllegalArgumentException("unknown expression")

fun main() {
    val result = eval(
        Sum(
            Sum(Num(1), Num(2)),
            Num(4)
        )
    )
    println(result) // 7
}
```

Bir if branch’inde yalnızca tek bir expression varsa süslü parantezler isteğe bağlıdır — bir block içeren if branch’inde
ise son expression sonuç olarak döndürülür. Birden fazla seçeneği ifade etmek için çok daha iyi bir language construct
ile tanıştın — hadi bu code’u biraz daha cilalayalım ve when kullanarak yeniden yazalım. When expression’ı, daha önce
gördüğün gibi yalnızca value’ları eşitlik açısından kontrol etmekle sınırlı değildir. Burada, when branch’lerinin farklı
bir formunu kullanırsın; bu form, when argüman value’sunun type’ını kontrol etmeni sağlar. if örneğinde olduğu gibi,
type check bir smart cast uygular; böylece Num ve Sum member'larına ekstra cast yapmadan erişebilirsin.

```kotlin
interface Expr
class Num(val value: Int) : Expr
class Sum(val left: Expr, val right: Expr) : Expr
class Sub(val left: Expr, val right: Expr) : Expr

fun eval(e: Expr): Int =
    when (e) {
        is Num -> e.value
        is Sum -> eval(e.left) + eval(e.right)
        else -> throw IllegalArgumentException("Unknown expression")
    }

fun main() {
    val result = eval(
        Sum(
            Sum(Num(1), Num(2)),
            Num(4)
        )
    )
    println(result) // 7
}
```

Birden fazla operation içeren branch logic’inde, branch body olarak bir block expression kullanabilirsin. Şimdi bunun
nasıl çalıştığına bakalım.